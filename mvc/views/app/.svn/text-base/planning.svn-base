<?php
    get::$title = 'Ajouter des salles en attentes';
    echo $html->h1('Gérer le planning');
    include("menu");
?>

<div class="span-12">

<?php
$profilAction = '/app/planning/' . $_SESSION['email'] . '/addPlanning';
if (!isset($profilAction)) {
    $profilAction = get::url(array('ssl' => false));
}

    echo $html->h2('Liste des salles en attente');

    if (isset($planning)) {
        echo '<ul>';
        foreach ($planning as $id_planning) {
            echo '<li class="item">
                    <div class="date"><strong>Date début</strong> : ' . get::component('date')->datetime_us_2_fr($id_planning['date_debut']) . '<br />
                        <strong>Date fin</strong> : ' . get::component('date')->datetime_us_2_fr($id_planning['date_fin']) . '<br />';
            if(!empty($id_planning['open_salle']))
            echo '<strong>Cette salle a une ouverture programmée</strong><br />';
            echo '</div><br />
                    <strong>Nom :</strong> ' . $id_planning['nom'] . '<br />';
            if(!empty($id_planning['descriptif']))
            echo '<strong>Descriptif</strong><br /> ' . $id_planning['descriptif'] . '<br />';
            
            echo '<div style="text-align: right;"><a href="/app/planning/Activate/' . $id_planning['nom'] . '">Créer salle</a>
            | <a href="/app/supprimer/planning/' . $id_planning['id_planning'] . '" id="supprimer" onclick="supprimer()">Supprimer</a></div></li>';
            echo '<hr />';
        }
        echo '</ul>';
    }else {
            echo '<div class="errormessage">Aucune salle n\'est créer.<br /> Vous pouvez en créer depuis le formulaire ci dessous</div>';
    }

    echo $html->h2('Créer un salle');

    if (isset($return['errors']))
        echo $return['errors'];

    echo $form->open(array('action' => $profilAction, 'method' => 'post', 'alert' => 'Les champs marqués d\'un astérisque sont obligatoires'));

    echo $form->input(array('type' => 'text', 'name' => 'nom', 'value' => '', 'label' => 'Nom de la salle *'));

    echo '<span class="horloge">';
    $args = array(
    'name' => 'date_debut',
    'time' => array('heure', 'minute', 'ampm'),
    'annee' => array('start' => '2011', 'end' => '2012'),
    'value' => array('jour' => date('d'), 'mois' => date('m'), 'annee' => date('Y'), 'heure' => date('h'), 'minute' => date('i')),
    'label' => 'Date d\'ouverture'
    );
    echo $form->dateSelect($args);
    $args = array(
    'name' => 'date_fin',
    'time' => array('heure', 'minute', 'ampm'),
    'annee' => array('start' => '2011', 'end' => '2012'),
    'value' => array('jour' => date('d'), 'mois' => date('m'), 'annee' => date('Y'), 'heure' => date('h'), 'minute' => date('i')),
    'label' => 'Date de fermeture'
    );
    echo $form->dateSelect($args);
    echo '</span>';
    
    echo $form->input(array('type' => 'textarea', 'name' => 'descriptif', 'value' => '', 'id' => 'descriptif', 'wysiwyg' => false));
    echo '<p><input type="checkbox" name="open_salle" id="open_salle" value="1" /> Ouverture de la salle programmée</p>';
    echo $form->input(array('type' => 'submit','name' => 'submit', 'value' => 'Creer'));
    echo $form->close();

?>

</div>

<span class="span-5">
    <h4>Aide</h4>
    Vous pouvez créer des salles a l'avance.<br /><br />
    Une fois les salles crées, vous n'avez rien à faire. Celle-ci se créer le jour prévu.<br /><br />
    Vous avez la possibilité de programmer vos salles jusqu'au 31/12/2012.

</span>

       <script type="text/javascript">
            $("a#supprimer").click(function(){
              resultat=window.confirm("Souhaitez vous vraiment supprimer ce groupe");
              if(resultat == false)
                  return false;
            });
        </script>